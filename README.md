# CompareDB - Comparaison SÃ©mantique Intelligente

Outil de comparaison sÃ©mantique de documents Excel avec intelligence artificielle.

---

## Installation et Lancement (Windows)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚   1. Double-cliquer sur  install.bat                        â”‚
â”‚      â†’ Installe Python et les dÃ©pendances                   â”‚
â”‚                                                             â”‚
â”‚   2. Double-cliquer sur  lancer.bat                         â”‚
â”‚      â†’ Ouvre l'interface sur http://localhost:8501          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Linux/Mac

```bash
pip install -r requirements.txt
streamlit run streamlit_app.py
```

---

## SchÃ©ma de la MÃ©thode de Comparaison

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PROCESSUS DE COMPARAISON                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   BASE 1     â”‚                              â”‚   BASE 2     â”‚
     â”‚   (Source)   â”‚                              â”‚   (Cible)    â”‚
     â”‚              â”‚                              â”‚              â”‚
     â”‚  Fichier.xlsxâ”‚                              â”‚  Fichier.xlsxâ”‚
     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                             â”‚
            â–¼                                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ã‰TAPE 1 : GÃ‰NÃ‰RATION DES EMBEDDINGS (Vectorisation IA)                     â”‚
â”‚                                                                             â”‚
â”‚  Chaque texte â†’ Vecteur numÃ©rique (embedding) capturant le sens            â”‚
â”‚                                                                             â”‚
â”‚  Exemple : "Le moteur dÃ©marre" â†’ [0.23, -0.45, 0.78, ...]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ã‰TAPE 2 : CALCUL DE SIMILARITÃ‰                                             â”‚
â”‚                                                                             â”‚
â”‚  Pour chaque ligne Base 1, calcul de la similaritÃ© cosinus avec Base 2     â”‚
â”‚                                                                             â”‚
â”‚  Score âˆˆ [0, 1]  â†’  1 = identique, 0 = totalement diffÃ©rent                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                   â”‚
                    â–¼                                   â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Score â‰¥ Seuil  â”‚                 â”‚  Score < Seuil  â”‚
          â”‚                 â”‚                 â”‚                 â”‚
          â”‚    MATCH âœ“      â”‚                 â”‚   MISMATCH âœ—    â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                                   â”‚
                   â”‚                                   â–¼
                   â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚               â”‚  Ã‰TAPE 3 : STRATÃ‰GIE COMBINATOIRE    â”‚
                   â”‚               â”‚  (optionnelle)                       â”‚
                   â”‚               â”‚                                      â”‚
                   â”‚               â”‚  Tente de combiner plusieurs lignes  â”‚
                   â”‚               â”‚  de Base 2 pour trouver un match     â”‚
                   â”‚               â”‚                                      â”‚
                   â”‚               â”‚  Exemple :                           â”‚
                   â”‚               â”‚  Base 1: "Support 1000 users < 2s"   â”‚
                   â”‚               â”‚  Base 2: [15] "Support 1000 users"   â”‚
                   â”‚               â”‚          [31] "Temps < 2 secondes"   â”‚
                   â”‚               â”‚  â†’ Combinaison [15+31] = Match âœ“     â”‚
                   â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                              â”‚
                   â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚          â”‚                  â”‚                  â”‚
                   â”‚          â–¼                  â”‚                  â–¼
                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  â”‚    MATCH      â”‚          â”‚         â”‚   MISMATCH    â”‚
                   â”‚  â”‚ COMBINATOIRE  â”‚          â”‚         â”‚   DÃ‰FINITIF   â”‚
                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚          â”‚                  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ã‰TAPE 4 : VALIDATION LLM (optionnelle)                                     â”‚
â”‚                                                                             â”‚
â”‚  L'IA examine chaque match et dÃ©termine :                                  â”‚
â”‚  â€¢ TRUE  â†’ Textes sÃ©mantiquement Ã©quivalents                               â”‚
â”‚  â€¢ FALSE â†’ Textes non Ã©quivalents                                          â”‚
â”‚  â€¢ Commentaire explicatif                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ã‰TAPE 5 : EXPORT EXCEL                                                     â”‚
â”‚                                                                             â”‚
â”‚  â€¢ matches_YYYYMMDD_HHMMSS.xlsx  â†’ Tous les matches trouvÃ©s                â”‚
â”‚  â€¢ under_YYYYMMDD_HHMMSS.xlsx    â†’ Mismatches (aucune correspondance)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Interface Utilisateur

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CompareDB                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          â”‚                                                  â”‚
â”‚  SIDEBAR (Configuration) â”‚  ZONE PRINCIPALE                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚                          â”‚                                                  â”‚
â”‚  â˜ Mode hors ligne       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚                          â”‚  â”‚   Fichier 1     â”‚  â”‚   Fichier 2     â”‚       â”‚
â”‚  ModÃ¨le LLM:             â”‚  â”‚   [Parcourir]   â”‚  â”‚   [Parcourir]   â”‚       â”‚
â”‚  [Qwen 2.5 3B â–¼]         â”‚  â”‚   Feuille: ___  â”‚  â”‚   Feuille: ___  â”‚       â”‚
â”‚                          â”‚  â”‚   Colonne: ___  â”‚  â”‚   Colonne: ___  â”‚       â”‚
â”‚  â–¶ ParamÃ¨tres avancÃ©s    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚    â€¢ Seuil: 0.78         â”‚                                                  â”‚
â”‚    â€¢ Batch: 16           â”‚         [â–¶ Lancer la comparaison]                â”‚
â”‚    â€¢ Limite lignes: 0    â”‚                                                  â”‚
â”‚    â˜ Analyse LLM         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â˜ Combinatoire        â”‚  â”‚  RÃ‰SULTATS                                â”‚   â”‚
â”‚      â€¢ Seuil combo: 0.65 â”‚  â”‚  âœ“ Matches: 150  âœ— Mismatches: 45        â”‚   â”‚
â”‚      â˜ Exclure matchÃ©s   â”‚  â”‚                                           â”‚   â”‚
â”‚  ğŸ“˜ Guide utilisateur    â”‚  â”‚                                           â”‚   â”‚
â”‚                          â”‚  â”‚  [ğŸ“¥ TÃ©lÃ©charger matches]                 â”‚   â”‚
â”‚                          â”‚  â”‚  [ğŸ“¥ TÃ©lÃ©charger mismatches]              â”‚   â”‚
â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Modes d'ExÃ©cution

| Mode | Description | PrÃ©requis |
|------|-------------|-----------|
| **En ligne** | APIs Snowflake + DALLEM | Connexion rÃ©seau |
| **Hors ligne** | ModÃ¨les locaux (Qwen, Mistral, BGE-M3) | GPU recommandÃ©, 16GB RAM |

---

## ParamÃ¨tres ClÃ©s

| ParamÃ¨tre | Description | Valeur par dÃ©faut |
|-----------|-------------|-------------------|
| **Seuil de similaritÃ©** | Score minimum pour un match normal (0-1) | 0.78 |
| **Analyse LLM** | Validation sÃ©mantique par IA | DÃ©sactivÃ© |
| **StratÃ©gie combinatoire** | Combine plusieurs lignes pour matcher | DÃ©sactivÃ© |
| **Max combinaisons** | Nombre max de lignes Ã  combiner | 4 |
| **Seuil combinatoire** | Score minimum pour un match combinatoire | 0.65 |
| **Exclure lignes matchÃ©es** | Ne pas rÃ©utiliser les lignes dÃ©jÃ  matchÃ©es | DÃ©sactivÃ© |

---

## Fichiers de RÃ©sultat

### matches_*.xlsx

| Colonne | Description |
|---------|-------------|
| `source` | Texte de la Base 1 |
| `target` | Texte correspondant de la Base 2 |
| `score` | Score de similaritÃ© (0-1) |
| `match_type` | "normal" ou "combinatorial" |
| `Ã©quivalence` | Validation LLM (TRUE/FALSE) |
| `commentaire` | Explication du LLM |

### under_*.xlsx

Lignes de la Base 1 sans correspondance dans la Base 2.

---

## Structure du Projet

```
CompareDB/
â”œâ”€â”€ install.bat           â† Installation (double-clic)
â”œâ”€â”€ lancer.bat            â† Lancement (double-clic)
â”œâ”€â”€ streamlit_app.py      â† Application principale
â”œâ”€â”€ offline_models.py     â† Configuration modÃ¨les locaux
â”œâ”€â”€ requirements.txt      â† DÃ©pendances Python
â”œâ”€â”€ README.md             â† Ce fichier
â”œâ”€â”€ USER_GUIDE.md         â† Guide utilisateur dÃ©taillÃ©
â””â”€â”€ output/               â† RÃ©sultats Excel gÃ©nÃ©rÃ©s
```

---

## DÃ©pannage

| ProblÃ¨me | Solution |
|----------|----------|
| Python non reconnu | Installer Python 3.10+ et cocher "Add to PATH" |
| Port 8501 occupÃ© | `streamlit run streamlit_app.py --server.port 8502` |
| Mode hors ligne indisponible | `pip install torch transformers sentence-transformers` |

---

## Configuration Mode Hors Ligne

Modifier les chemins dans `offline_models.py` :

```python
AVAILABLE_LLM_MODELS = {
    "qwen": "C:\\Models\\Qwen\\Qwen2.5-3B-Instruct",
    "mistral": "C:\\Models\\mistralai\\Mistral-7B-Instruct-v0.3",
}
DEFAULT_EMBEDDING = "C:\\Models\\BAAI\\bge-m3"
```

---

**Licence** : PropriÃ©taire - Dassault Aviation
